<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meus Gastos ‚Äî Meus Gastos</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>

  <!-- React + ReactDOM (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel for JSX prototyping -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --g1: #10B981; /* green */
      --g2: #3B82F6; /* blue */
      --card: rgba(255,255,255,0.9);
      --glass: rgba(255,255,255,0.06);
    }
    body{ -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    .brand-gradient{ background: linear-gradient(135deg,var(--g1),var(--g2)); }
    .accent-btn{ background: linear-gradient(90deg,var(--g1),var(--g2)); color: white; }
    .card{ background: white; }
    .dark .card{ background: #0f1724; }
    .chip{ transition: transform .12s, box-shadow .12s; }
    .chip:active{ transform: translateY(1px); }
    .card-anim{ transform-origin:center; transition: transform .18s ease, box-shadow .18s ease; }
    .card-anim:hover{ transform: translateY(-8px); box-shadow: 0 20px 40px rgba(2,6,23,0.12); }
    @media (max-width:768px){
      .app-shell{ padding: 18px; }
    }
    canvas{ max-width:100% !important; height:auto !important; }
    /* center donut text */
    .donut-center { display:flex; align-items:center; justify-content:center; position:relative; pointer-events:none; }
  </style>
</head>
<body class="bg-gradient-to-b from-white to-slate-50 dark:from-gray-900 dark:to-slate-900 text-slate-900 dark:text-slate-100">

<div id="root"></div>

<script type="text/babel">
/* Meus Gastos ‚Äî vers√£o visual melhorada (donut + √≠cones) */
const { useState, useEffect, useMemo, useRef } = React;

const APP_NAME = "Meus Gastos";
const PROFILE_KEY = "meus_gastos_profile_v1";
const TX_KEY = "meus_gastos_transactions_v1";

/* categories with simple SVG icons (inline for no deps) */
const CATEGORIES = [
  { id:'alimentacao', name:'Alimenta√ß√£o', color:'#10B981', icon: svgForkKnife() },
  { id:'transporte', name:'Transporte', color:'#0EA5A9', icon: svgCar() },
  { id:'lazer', name:'Lazer', color:'#F59E0B', icon: svgStar() },
  { id:'moradia', name:'Moradia', color:'#3B82F6', icon: svgHome() },
  { id:'cartoes', name:'Cart√µes', color:'#7C3AED', icon: svgCreditCard() },
  { id:'faculdade', name:'Faculdade', color:'#06B6D4', icon: svgBook() },
  { id:'internet', name:'Internet', color:'#60A5FA', icon: svgWifi() },
  { id:'luz', name:'Luz', color:'#F97316', icon: svgBolt() },
  { id:'agua', name:'√Å0BFF', color:'#06B6D4', icon: svgWater() }, // slight fallback color
  { id:'saude', name:'Sa√∫de', color:'#84CC16', icon: svgHeart() },
  { id:'outros', name:'Outros', color:'#94A3B8', icon: svgDots() },
];

/* ---------- utility & storage ---------- */
function genId(){ return 'id-'+Date.now().toString(36)+'-'+Math.random().toString(36).slice(2,8); }
function monthKeyFromDate(dateStr){ return dateStr ? dateStr.slice(0,7) : new Date().toISOString().slice(0,7); }
function addOneMonthToDate(dateStr){
  const d = dateStr ? new Date(dateStr+'T00:00:00') : new Date();
  const day = d.getDate(), m = d.getMonth(), y = d.getFullYear();
  let nm = m + 1, ny = y; if(nm > 11){ nm = 0; ny = y+1; }
  const cand = new Date(ny, nm, day);
  if(cand.getMonth() !== nm){ const lastDay = new Date(ny, nm+1, 0).getDate(); return `${ny}-${String(nm+1).padStart(2,'0')}-${String(lastDay).padStart(2,'0')}`; }
  return `${ny}-${String(nm+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
}

function loadProfile(){ try{ const r=localStorage.getItem(PROFILE_KEY); return r?JSON.parse(r):null }catch{return null} }
function saveProfile(p){ try{ localStorage.setItem(PROFILE_KEY, JSON.stringify(p)); }catch{} }
function loadTransactions(){
  try{
    const raw = localStorage.getItem(TX_KEY);
    if(!raw){
      // initial sample
      return [
        { id:genId(), type:'income', category:'outros', amount:2500, date:'2025-10-01', description:'Sal√°rio', fixed:false },
        { id:genId(), type:'expense', category:'luz', amount:120, date:'2025-10-05', description:'Conta de luz', fixed:true },
        { id:genId(), type:'expense', category:'agua', amount:60, date:'2025-10-06', description:'Conta de √°gua', fixed:true },
        { id:genId(), type:'expense', category:'internet', amount:99.9, date:'2025-10-10', description:'Internet', fixed:true },
        { id:genId(), type:'expense', category:'alimentacao', amount:45.5, date:'2025-10-25', description:'Almo√ßo', fixed:false },
      ];
    }
    return JSON.parse(raw);
  }catch(e){ console.error(e); return []; }
}
function saveTransactions(data){ try{ localStorage.setItem(TX_KEY, JSON.stringify(data)); }catch(e){ console.error(e); } }

/* ---------- theme toggle ---------- */
function ThemeToggle(){ const [dark,setDark]=useState(()=> localStorage.getItem('theme')==='dark'); useEffect(()=>{ const root=document.documentElement; if(dark) root.classList.add('dark'); else root.classList.remove('dark'); localStorage.setItem('theme', dark? 'dark' : 'light'); }, [dark]); return (<button onClick={()=>setDark(d=>!d)} className="p-2 rounded-md bg-white/90 dark:bg-slate-800 border shadow-sm">{dark? 'üåô' : '‚òÄÔ∏è'}</button>) }

/* ---------- Pie (donut) with center text plugin ---------- */
function useDonutChart(canvasRef, data, centerText, colors){
  useEffect(()=>{
    if(!canvasRef.current) return;
    const ctx = canvasRef.current.getContext('2d');
    // plugin to draw center text
    const centerPlugin = {
      id: 'centerText',
      beforeDraw(chart){
        const { width, height, ctx } = chart;
        ctx.save();
        const fontSize = Math.round(Math.min(width, height) / 10);
        ctx.font = `${fontSize}px sans-serif`;
        ctx.fillStyle = '#111827';
        if(document.documentElement.classList.contains('dark')) ctx.fillStyle = '#E5E7EB';
        const txt = centerText || '';
        const textX = Math.round((width - ctx.measureText(txt).width) / 2);
        const textY = Math.round(height / 2 + fontSize/4);
        ctx.fillText(txt, textX, textY);
        ctx.restore();
      }
    };
    // build chart
    const labels = data.map(d=>d.name);
    const vals = data.map(d=>d.value);
    const cfg = {
      type: 'doughnut',
      data: { labels, datasets: [{ data: vals, backgroundColor: colors }] },
      options: { cutout: '68%', plugins: { legend: { display: false } } },
      plugins: [centerPlugin]
    };
    let chart = Chart.getChart(canvasRef.current);
    if(chart) chart.destroy();
    chart = new Chart(ctx.canvas, cfg);
    return ()=> chart.destroy();
  }, [canvasRef, data, centerText, colors]);
}

/* ---------- UI Components ---------- */

/* icons as functions returning SVG strings for embedding into dangerouslySetInnerHTML */
function Icon({svg, size=18}){ return <span className="inline-flex" dangerouslySetInnerHTML={{__html: svg}} style={{width:size, height:size}} />; }

/* Transaction Form */
function TransactionForm({onAdd, editing, onUpdate, onCancel}){
  const [form, setForm] = useState({ type:'expense', category:'alimentacao', amount:'', date:'', description:'', fixed:false });
  useEffect(()=> { if(editing) setForm(editing); else setForm({ type:'expense', category:'alimentacao', amount:'', date:'', description:'', fixed:false }); }, [editing]);

  function handle(e){ const {name, value, type, checked} = e.target; setForm(prev=>({...prev, [name]: type==='checkbox'? checked : value })); }
  function submit(e){ e.preventDefault(); if(!form.amount || isNaN(Number(form.amount))) return alert('Digite um valor v√°lido'); const payload = {...form, id: form.id || genId(), amount: Number(form.amount), date: form.date || new Date().toISOString().slice(0,10)}; editing ? onUpdate(payload) : onAdd(payload); setForm({ type:'expense', category:'alimentacao', amount:'', date:'', description:'', fixed:false }); }

  return (
    <form onSubmit={submit} className="p-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm card-anim">
      <h3 className="font-semibold mb-3"> {editing? 'Editar' : 'Nova'} transa√ß√£o </h3>
      <div className="grid grid-cols-2 gap-2 mb-2">
        <select name="type" value={form.type} onChange={handle} className="p-2 rounded bg-gray-100 dark:bg-slate-700">
          <option value="expense">Despesa</option>
          <option value="income">Receita</option>
        </select>
        <select name="category" value={form.category} onChange={handle} className="p-2 rounded bg-gray-100 dark:bg-slate-700">
          {CATEGORIES.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}
        </select>
      </div>
      <input name="amount" value={form.amount} onChange={handle} placeholder="Valor (ex: 45.50)" className="w-full p-2 rounded mb-2 bg-gray-100 dark:bg-slate-700" />
      <input name="date" type="date" value={form.date} onChange={handle} className="w-full p-2 rounded mb-2 bg-gray-100 dark:bg-slate-700" />
      <input name="description" value={form.description} onChange={handle} placeholder="Descri√ß√£o (opcional)" className="w-full p-2 rounded mb-2 bg-gray-100 dark:bg-slate-700" />
      <label className="flex items-center gap-2 mb-3 text-sm">
        <input type="checkbox" name="fixed" checked={form.fixed} onChange={handle} />
        <span>Marcar como despesa fixa</span>
      </label>
      <div className="flex gap-2">
        <button type="submit" className="flex-1 py-2 rounded accent-btn hover:brightness-95 transition">{editing? 'Atualizar' : 'Adicionar'}</button>
        {editing && <button type="button" onClick={onCancel} className="px-3 py-2 rounded bg-gray-200 dark:bg-slate-700">Cancelar</button>}
      </div>
    </form>
  );
}

/* Transaction list */
function TransactionList({transactions, onEdit, onDelete, onToggleFixed}){
  function catName(id){ return CATEGORIES.find(c=>c.id===id)?.name || id; }
  return (
    <div className="p-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm card-anim mt-4">
      <h3 className="font-semibold mb-3">Hist√≥rico</h3>
      <div className="space-y-3 max-h-64 overflow-auto">
        {transactions.length===0 && <div className="text-sm text-gray-500">Nenhuma transa√ß√£o neste m√™s.</div>}
        {transactions.map(t => (
          <div key={t.id} className="flex items-center justify-between p-2 rounded hover:bg-gray-50 dark:hover:bg-slate-700">
            <div>
              <div className="text-sm font-medium">{t.description || catName(t.category)}</div>
              <div className="text-xs text-gray-500">{catName(t.category)} ‚Ä¢ {t.date}</div>
            </div>
            <div className="flex items-center gap-3">
              <div className={`${t.type==='income' ? 'text-green-600' : 'text-red-500'} font-semibold`}>R$ {Number(t.amount).toFixed(2)}</div>
              <input type="checkbox" checked={!!t.fixed} onChange={()=> onToggleFixed(t.id)} title="Despesa fixa" />
              <button onClick={()=> onEdit(t)} className="text-sm text-blue-500">Editar</button>
              <button onClick={()=> { if(confirm('Excluir?')) onDelete(t.id); }} className="text-sm text-red-500">Excluir</button>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

/* Category chips (interactive icons) */
function CategoryChips({ categories, activeCat, onSelect }){
  return (
    <div className="flex flex-wrap gap-2">
      <button onClick={()=> onSelect(null)} className={`chip flex items-center gap-2 px-3 py-1 rounded-full ${!activeCat ? 'bg-gray-900/5 dark:bg-white/5' : 'bg-white/80 dark:bg-slate-800'} text-sm`}>Todos</button>
      {categories.map(c => (
        <button key={c.id} onClick={()=> onSelect(c.id)} className={`chip inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm ${activeCat===c.id ? 'ring-2 ring-offset-1 ring-indigo-400' : 'bg-white/80 dark:bg-slate-800'}`}>
          <span className="w-6 h-6 rounded-full flex items-center justify-center" style={{background:c.color+'22'}} dangerouslySetInnerHTML={{__html:c.icon}} />
          <span>{c.name}</span>
        </button>
      ))}
    </div>
  );
}

/* Donut wrapper component that draws center text */
function DonutWithCenter({data, total, colors, filterCategory, onClickSegment}){
  const canvasRef = useRef(null);
  // Draw donut and center number using Chart.js plugin
  useEffect(()=>{
    if(!canvasRef.current) return;
    // prepare
    const labels = data.map(d=>d.name);
    const vals = data.map(d=>d.value);
    const bg = colors.slice(0, vals.length);
    // center plugin
    const centerPlugin = {
      id: 'centerText',
      beforeDraw(chart){
        const { ctx, width, height } = chart;
        ctx.save();
        // outer: value
        const value = total !== undefined ? `R$ ${Number(total).toFixed(2)}` : '';
        ctx.font = `600 ${Math.round(Math.min(width,height)/12)}px sans-serif`;
        ctx.fillStyle = document.documentElement.classList.contains('dark') ? '#E6EEF8' : '#0f1724';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(value, width/2, height/2 - 6);
        // label
        ctx.font = `400 ${Math.round(Math.min(width,height)/26)}px sans-serif`;
        ctx.fillStyle = ctx.fillStyle;
        ctx.fillText('Total', width/2, height/2 + 20);
        ctx.restore();
      }
    };
    // create/destroy
    const old = Chart.getChart(canvasRef.current);
    if(old) old.destroy();
    const cfg = new Chart(canvasRef.current, {
      type: 'doughnut',
      data: { labels, datasets:[{ data: vals, backgroundColor: bg }] },
      options: { cutout: '65%', plugins: { legend: { display:false } }, onClick(evt, elems){ if(elems.length>0){ const idx = elems[0].index; onClickSegment && onClickSegment(labels[idx]); } } },
      plugins: [centerPlugin]
    });
    return ()=> cfg.destroy();
  }, [canvasRef, data, total, colors, onClickSegment]);
  return <div className="relative"><canvas ref={canvasRef} className="w-full h-48" /></div>;
}

/* Profile / onboarding */
function ProfileForm({ onSave }){
  const [name, setName] = useState(''); const [dob,setDob] = useState('');
  function submit(e){ e.preventDefault(); if(!name) return alert('Digite seu nome'); onSave({ name, dob }); }
  return (
    <form onSubmit={submit} className="space-y-3">
      <input value={name} onChange={e=>setName(e.target.value)} placeholder="Seu nome" className="w-full p-3 rounded" />
      <input value={dob} onChange={e=>setDob(e.target.value)} type="date" className="w-full p-3 rounded" />
      <button className="w-full py-3 rounded accent-btn">Come√ßar</button>
    </form>
  );
}

/* Import button */
function ImportButton({ onImport }){
  const ref = useRef(null);
  function handleFile(e){
    const f = e.target.files[0]; if(!f) return;
    const reader = new FileReader(); reader.onload = ()=> onImport(reader.result); reader.readAsText(f); e.target.value = '';
  }
  return (<>
    <input ref={ref} type="file" accept="application/json" className="hidden" onChange={handleFile} />
    <button onClick={()=> ref.current.click()} className="px-3 py-2 rounded bg-white/90 dark:bg-slate-800">Importar</button>
  </>);
}

/* ---------- Main App ---------- */
function App(){
  const [profile, setProfile] = useState(()=> loadProfile());
  const [transactions, setTransactions] = useState(()=> loadTransactions());
  const [editing, setEditing] = useState(null);
  const [selectedMonth, setSelectedMonth] = useState(()=> new Date().toISOString().slice(0,7));
  const [activeCategory, setActiveCategory] = useState(null);

  useEffect(()=> saveProfile(profile), [profile]);
  useEffect(()=> saveTransactions(transactions), [transactions]);

  // derived
  const transactionsForMonth = useMemo(()=> transactions.filter(t=> monthKeyFromDate(t.date) === selectedMonth).sort((a,b)=> b.date.localeCompare(a.date)), [transactions, selectedMonth]);
  const totalForMonth = useMemo(()=> transactionsForMonth.reduce((s,t)=> t.type==='income'? s + t.amount : s - t.amount, 0), [transactionsForMonth]);
  const byCategoryForMonth = useMemo(()=> {
    const map = {}; CATEGORIES.forEach(c=>map[c.id]=0);
    transactionsForMonth.forEach(t=>{ if(t.type==='expense') map[t.category] = (map[t.category]||0) + t.amount; });
    return CATEGORIES.map(c=>({ name:c.name, id:c.id, value: map[c.id] })).filter(d=>d.value>0 && (!activeCategory || d.id===activeCategory));
  }, [transactionsForMonth, activeCategory]);
  const barDataForMonth = useMemo(()=> {
    const map={};
    transactionsForMonth.forEach(t => { const day = t.date.slice(8,10); map[day] = (map[day]||0) + (t.type==='expense'? t.amount : -t.amount); });
    return Object.entries(map).sort((a,b)=>a[0]-b[0]).map(([k,v])=>({label:k, value:v}));
  }, [transactionsForMonth]);

  const availableMonths = useMemo(()=> {
    const s = new Set(transactions.map(t=> monthKeyFromDate(t.date))); s.add(new Date().toISOString().slice(0,7)); return Array.from(s).filter(Boolean).sort().reverse();
  }, [transactions]);

  // actions
  function addTransaction(tx){ setTransactions(prev=> [tx, ...prev]); }
  function updateTransaction(u){ setTransactions(prev=> prev.map(p=> p.id === u.id ? u : p)); setEditing(null); }
  function deleteTransaction(id){ setTransactions(prev=> prev.filter(p=> p.id !== id)); }
  function toggleFixed(id){ setTransactions(prev=> prev.map(p=> p.id === id? {...p, fixed: !p.fixed} : p)); }

  function copyFixedToNextMonth(){
    const fixed = transactionsForMonth.filter(t=> t.fixed);
    if(fixed.length===0) return alert('N√£o h√° despesas fixas no m√™s selecionado.');
    const nextKey = (()=>{ const [y,m]=selectedMonth.split('-').map(Number); let nm=m+1, ny=y; if(nm>12){ nm=1; ny+=1 } return `${ny}-${String(nm).padStart(2,'0')}` })();
    const newItems = fixed.map(t=> ({ ...t, id: genId(), date: addOneMonthToDate(t.date) }));
    // duplicates check
    const duplicates = newItems.filter(ni => transactions.some(ex => monthKeyFromDate(ex.date) === nextKey && ex.description === ni.description && ex.amount === ni.amount && ex.category === ni.category));
    if(duplicates.length>0){
      if(!confirm(`Existem ${duplicates.length} itens iguais no pr√≥ximo m√™s. Deseja adicionar mesmo assim?`)){
        const nonDup = newItems.filter(ni => !duplicates.some(d => d.description===ni.description && d.amount===ni.amount && d.category===ni.category));
        if(nonDup.length>0) setTransactions(prev => [...nonDup, ...prev]);
        return;
      }
    }
    setTransactions(prev => [...newItems, ...prev]);
    alert('Despesas fixas copiadas para o pr√≥ximo m√™s.');
  }

  function exportJSON(){ const blob = new Blob([JSON.stringify(transactions, null, 2)], { type:'application/json' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='meus_gastos_backup.json'; a.click(); URL.revokeObjectURL(url); }
  function importJSONString(str){ try{ const parsed = JSON.parse(str); if(!Array.isArray(parsed)) throw new Error('Formato inv√°lido'); const fixed = parsed.map(p=> ({ id: p.id || genId(), type: p.type, category: p.category || 'outros', amount: Number(p.amount)||0, date: p.date || new Date().toISOString().slice(0,10), description: p.description||'', fixed: !!p.fixed })); setTransactions(prev=> [...fixed, ...prev]); alert('Importado com sucesso'); }catch(e){ alert('Erro ao importar: '+ e.message); } }

  function gotoPrevMonth(){ const [y,m] = selectedMonth.split('-').map(Number); let nm = m-1, ny = y; if(nm<1){ nm = 12; ny -=1 } setSelectedMonth(`${ny}-${String(nm).padStart(2,'0')}`); }
  function gotoNextMonth(){ const [y,m] = selectedMonth.split('-').map(Number); let nm = m+1, ny = y; if(nm>12){ nm = 1; ny +=1 } setSelectedMonth(`${ny}-${String(nm).padStart(2,'0')}`); }

  if(!profile){
    return (
      <div className="min-h-screen flex items-center justify-center app-shell p-6">
        <div className="w-full max-w-md rounded-3xl p-6 brand-gradient text-white shadow-xl">
          <h1 className="text-3xl font-bold mb-2">{APP_NAME}</h1>
          <p className="opacity-90 mb-4">Crie seu perfil r√°pido para come√ßar.</p>
          <ProfileForm onSave={(p)=>{ setProfile(p); saveProfile(p); }} />
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen p-6 app-shell">
      <div className="max-w-6xl mx-auto">
        <header className="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6">
          <div>
            <h1 className="text-2xl font-bold flex items-center gap-3">
              <span className="rounded-full w-10 h-10 flex items-center justify-center bg-white/20 text-white">{APP_NAME.split(' ')[0][0]}</span>
              {APP_NAME}
            </h1>
            <div className="text-sm text-gray-600 dark:text-gray-300">Ol√°, <strong>{profile.name}</strong> üëã</div>
          </div>

          <div className="flex items-center gap-2">
            <div className="flex items-center gap-1 bg-white/90 dark:bg-slate-800 p-2 rounded shadow">
              <button onClick={gotoPrevMonth} className="px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-slate-700">‚óÄ</button>
              <input type="month" value={selectedMonth} onChange={e=> setSelectedMonth(e.target.value)} className="bg-transparent text-sm" />
              <button onClick={gotoNextMonth} className="px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-slate-700">‚ñ∂</button>
            </div>

            <button onClick={copyFixedToNextMonth} className="px-3 py-2 rounded bg-amber-500 text-white">Copiar fixas ‚Üí pr√≥ximo m√™s</button>
            <button onClick={exportJSON} className="px-3 py-2 rounded bg-white/90 dark:bg-slate-800">Exportar</button>
            <ImportButton onImport={(txt)=> importJSONString(txt)} />
            <ThemeToggle />
          </div>
        </header>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <aside className="lg:col-span-1">
            <TransactionForm onAdd={(t)=> addTransaction(t)} editing={editing} onUpdate={updateTransaction} onCancel={()=> setEditing(null)} />
            <div className="mt-4 flex gap-2">
              <button onClick={()=> { if(confirm('Limpar todas as transa√ß√µes?')) setTransactions([]); }} className="flex-1 py-2 rounded bg-red-500 text-white">Limpar tudo</button>
              <button onClick={()=> { setTransactions(loadTransactions()); alert('Exemplo restaurado') }} className="flex-1 py-2 rounded bg-white/90 dark:bg-slate-800">Restaurar</button>
            </div>
          </aside>

          <main className="lg:col-span-2 space-y-4">
            <div className="p-4 rounded-2xl bg-white dark:bg-slate-800 shadow-sm card-anim">
              <div className="flex items-center justify-between">
                <div>
                  <div className="text-sm text-gray-500">Saldo (m√™s selecionado)</div>
                  <div className={`text-2xl font-bold ${totalForMonth >= 0 ? 'text-green-600' : 'text-red-500'}`}>R$ {totalForMonth.toFixed(2)}</div>
                  <div className="text-xs text-gray-500 mt-1">{transactionsForMonth.length} transa√ß√µes</div>
                </div>

                <div className="w-64">
                  <div className="text-sm text-gray-500">Resumo</div>
                  <div className="mt-1 text-sm">
                    <div>Receitas: R$ {transactionsForMonth.filter(t=>t.type==='income').reduce((s,t)=> s + t.amount,0).toFixed(2)}</div>
                    <div>Despesas: R$ {transactionsForMonth.filter(t=>t.type==='expense').reduce((s,t)=> s + t.amount,0).toFixed(2)}</div>
                  </div>
                </div>
              </div>

              <div className="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <div className="flex items-center justify-between mb-2">
                    <h4 className="text-sm font-medium">Despesas por categoria</h4>
                    <div className="text-xs text-gray-500">Toque nos √≠cones para filtrar</div>
                  </div>
                  <CategoryChips categories={CATEGORIES} activeCat={activeCategory} onSelect={(c)=> setActiveCategory(c)} />
                  <div className="mt-3">
                    <DonutWithCenter data={byCategoryForMonth} total={ byCategoryForMonth.reduce((s,d)=> s + d.value, 0) } colors={ byCategoryForMonth.map((d,i)=> ['#10B981','#059669','#06B6D4','#3B82F6','#60A5FA','#7DD3FC','#0EA5A9','#34D399','#FBBF24'][i % 9] ) } onClickSegment={(label)=> { const found = CATEGORIES.find(c=>c.name === label); if(found) setActiveCategory(found.id); }} />
                  </div>
                </div>

                <div>
                  <h4 className="text-sm font-medium mb-2">Fluxo por dia</h4>
                  <div className="card p-3">
                    <BarCanvas data={barDataForMonth} />
                  </div>
                </div>
              </div>
            </div>

            <TransactionList transactions={transactionsForMonth} onEdit={(t)=> setEditing(t)} onDelete={deleteTransaction} onToggleFixed={toggleFixed} />
          </main>
        </div>

        <footer className="mt-6 text-center text-sm text-gray-500">¬© 2025 Italo Rocha</footer>
      </div>
    </div>
  );
}

/* ---------- small helpers to adapt original functions used above ---------- */
function addTransaction(tx){ const root = document.querySelector('#root'); /* placeholder; real add is inside App via closure */ }

/* ---------- render ---------- */
ReactDOM.createRoot(document.getElementById('root')).render(<App />);

/* ---------- SVG icon functions (return inline SVG) ---------- */
function svgForkKnife(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M11 2v8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M5 15v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M5 21h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`; }
function svgCar(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="7" width="18" height="8" rx="2" stroke="currentColor" stroke-width="1.4"/><circle cx="7.5" cy="17.5" r="1.5" fill="currentColor"/><circle cx="16.5" cy="17.5" r="1.5" fill="currentColor"/></svg>`; }
function svgStar(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 17.3l-6.16 3.24 1.18-6.88L2 9.76l6.92-1.01L12 2l3.08 6.75L22 9.76l-5.02 3.9 1.18 6.88z" stroke="currentColor" stroke-width="0.6"/></svg>`; }
function svgHome(){ return `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 11.5L12 4l9 7.5" stroke="currentColor" stroke-width="1.4"/><path d="M5 21V12h14v9" stroke="currentColor" stroke-width="1.4"/></svg>`; }
function svgCreditCard(){ return `<svg viewBox="0 0 24 24" fill="none"><rect x="2" y="5" width="20" height="14" rx="2" stroke="currentColor" stroke-width="1.4"/><path d="M2 10h20" stroke="currentColor" stroke-width="1.4"/></svg>`; }
function svgBook(){ return `<svg viewBox="0 0 24 24" fill="none"><path d="M4 19.5V6a2 2 0 0 1 2-2h11" stroke="currentColor" stroke-width="1.4"/><path d="M20 7v12.5a.5.5 0 0 1-.65.48C18.44 19.6 16.6 19 14 19c-1.1 0-2 .1-3 .5V6" stroke="currentColor" stroke-width="1.4"/></svg>`; }
function svgWifi(){ return `<svg viewBox="0 0 24 24" fill="none"><path d="M2 8.5a15 15 0 0 1 20 0" stroke="currentColor" stroke-width="1.4"/><path d="M6 12a9 9 0 0 1 12 0" stroke="currentColor" stroke-width="1.4"/><path d="M10 16a3 3 0 0 1 4 0" stroke="currentColor" stroke-width="1.4"/></svg>`; }
function svgBolt(){ return `<svg viewBox="0 0 24 24" fill="none"><path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z" stroke="currentColor" stroke-width="1.2"/></svg>`; }
function svgWater(){ return `<svg viewBox="0 0 24 24" fill="none"><path d="M12 2s5 4.5 5 8.5A5 5 0 0 1 7 10.5C7 6.5 12 2 12 2z" stroke="currentColor" stroke-width="1.2"/></svg>`; }
function svgHeart(){ return `<svg viewBox="0 0 24 24" fill="none"><path d="M12 21s-7-4.35-9-7.04A5.56 5.56 0 0 1 7 6.04 5 5 0 0 1 12 9a5 5 0 0 1 5-2.96c2 0 5 2.96 4 7.92C19 16.65 12 21 12 21z" stroke="currentColor" stroke-width="1.2"/></svg>`; }
function svgDots(){ return `<svg viewBox="0 0 24 24" fill="none"><circle cx="5" cy="12" r="1.5" fill="currentColor"/><circle cx="12" cy="12" r="1.5" fill="currentColor"/><circle cx="19" cy="12" r="1.5" fill="currentColor"/></svg>`; }

</script>
</body>
</html>
